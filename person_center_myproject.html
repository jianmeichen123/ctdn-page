<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>个人中心</title>
	<!--basis-->
	{(dn_basis.html)}
	<link rel='style/sheet'/>
</head>

<body>
{(header.html)}
<div class='person-center-container clearfix'>
	{(person_center_header.html)}
	<div class='person-right fl'>
		<ul class='clearfix person_tab'>
			<li class='person-tab-underline' >审核中</li>
			<li >已审核</li>
		</ul>
		<input type="hidden" id="isClaim" value="0">
		<div class='person-project-list person_checking' style="display:none">
				<table  data-toggle='table' data-url >
					<thead>
						<tr>
							<th data-field="projectName">项目名称</th>
							<th data-formatter="districtFormatter">所属地区</th>
							<th data-field="linkName">联系人</th>
							<th data-field="linkPhone1">电话</th>
							<th data-formatter="option"></th>
						</tr>
					</thead>
				</table>
		</div>
		<a href='seek_financing.html'><div class='person-upload-project'>上传新的项目</div></a>
	</div>
</div>
 {(dn_foot.html)}
</body>
<script src="js/table-init.js"></script>
<script>
$('.person_tab li').click(function(){
	$(this).addClass('person-tab-underline').siblings().removeClass('person-tab-underline');
	$("#isClaim").val($(this).index())
	if(getCookie("_uid_")){
			loadTable();
	}

});
if(getCookie("_uid_")){
			loadTable();
}
sendPostRequestByJsonObj(publicsea.queryPubSeaList,{"userId":getCookie("_usercode_")},function(data){
	if(data.records.length==0){
		$("table[data-url]").bootstrapTable("destroy");
	}
})
function loadTable(){
	$("table[data-url]").bootstrapTable("refreshOptions",{
			url: publicsea.queryPubSeaList,         //请求后台的URL（*）
			queryParams:queryParams,
			formatNoMatches: function () {  //没有匹配的结果
				var result =  "<a href='seek_financing.html'><div class='person-upload-project'>上传新的项目</div></a>"
				return result;
            },
	});
	function queryParams(params) {   //设置查询参数
		var param = {
			"pageSize":params.pageSize,   //页面大小
			"pageNo":params.pageNumber,  //页码
			"userId":getCookie("_usercode_"),
			"isClaim":$("#isClaim").val()
		};
		return param;//参数
	}
}

function districtFormatter(value,row){
	return row.area1Name+"<span>></span>"+row.area2Name;
}
function option(value,row){
	return "<a href='person_edit_project.html?projectId="+row.projectId+"' >编辑</a>"
}
</script>
</html>